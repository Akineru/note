# **OSI七层网络层：**

### 应用层：

负责给应用程序提供统一的接口；

### 表示层：

负责把数据转换成兼容另一个系统能识别的格式；

### 会话层：

负责建立、管理和终止表示层实体之间的通信会话；

### 传输层：

负责端到端的数据传输；

### 网络层：

负责数据的路由、转发、分片；

### 数据链路层：

负责数据的封帧和差错检测，以及 MAC 寻址；

### 物理层：

负责在物理网络中传输数据帧；

# **TCP/IP四层模型：**

### 应用层：

给用户提供应用功能，比如 HTTP、FTP、Telnet、DNS、SMTP等。

### 传输层：

为应用层提供网络支持的。有两个传输协议，分别是 TCP 和 UDP。

### 网络层：

实现数据的具体传输。IP协议：**寻址，路由**
IP 协议的寻址作用是告诉我们去往下一个目的地该朝哪个方向走，路由则是根据「下一个目的地」选择路径。寻址更像在导航，路由更像在操作方向盘。

IP协议分为两部分：
网络号，负责标识该 IP 地址是属于哪个「子网」的；
主机号，负责标识同一「子网」下的不同主机；
ep:10.100.122.0/24，后面的/24表示就是 255.255.255.0 子网掩码
255.255.255.0 二进制是「11111111-11111111-11111111-00000000」，24 个1，为了简化子网掩码的表示，用/24代替255.255.255.0。
将IP地址和子网掩码做and运算，就可以得到 网络号

![img](https://img2022.cnblogs.com/blog/2411751/202210/2411751-20221016140241180-639439635.png)

### 网络接口层：

生成了 IP 头部之后，接下来要交给网络接口层（Link Layer）在 IP 头部的前面加上 MAC 头部，并封装成数据帧（Data frame）发送到网络上。
网络接口层主要为网络层提供「链路级别」传输的服务，负责在以太网、WiFi 这样的底层网络上发送原始数据包，工作在网卡这个层次，使用 MAC 地址来标识网络上的设备。

# **键入网址到网页显示，期间发生了什么？**

### 1、浏览器解析URL，然后生成发给web服务器的HTTP请求信息

![image](https://img2022.cnblogs.com/blog/2411751/202210/2411751-20221016142306430-424464538.png)

### 2、DNS域名解析。

浏览器首先会查看自己有没有该域名的缓存；然后查看操作系统的缓存；然后查看本地host的缓存；都没有才会去问本地DNS服务器。
客户端首先会发出一个 DNS 请求，问 www.server.com 的 IP 是啥，并发给本地 DNS 服务器（也就是客户端的 TCP/IP 设置中填写的 DNS 服务器地址）。
本地域名服务器收到客户端的请求后，如果缓存里的表格能找到 www.server.com，则它直接返回 IP 地址。如果没有，本地 DNS 会去问它的根域名服务器：“老大， 能告诉我 www.server.com 的 IP 地址吗？” 根域名服务器是最高层次的，它不直接用于域名解析，但能指明一条道路。
根 DNS 收到来自本地 DNS 的请求后，发现后置是 .com，说：“www.server.com 这个域名归 .com 区域管理”，我给你 .com 顶级域名服务器地址给你，你去问问它吧。”
本地 DNS 收到顶级域名服务器的地址后，发起请求问“老二， 你能告诉我 www.server.com 的 IP 地址吗？”
顶级域名服务器说：“我给你负责 www.server.com 区域的权威 DNS 服务器的地址，你去问它应该能问到”。
本地 DNS 于是转向问权威 DNS 服务器：“老三，www.server.com对应的IP是啥呀？” server.com 的权威 DNS 服务器，它是域名解析结果的原出处。。
权威 DNS 服务器查询后将对应的 IP 地址 X.X.X.X 告诉本地 DNS。
本地 DNS 再将 IP 地址返回客户端，客户端和目标建立连接。

### **3、TCP/IP传输**

通过三次握手建立TCP连接然后委托 IP 模块将数据封装成网络包发送给通信对象，依次添加IP头部，MAC头部，根据路由表和广播获取接收方的MAC地址，在获得后会将查询结果放进ARP缓存；
所以在发包时，会先查询ARP缓存有无对方的MAC地址。如果没有，才进行广播查询

### **4、通过网卡和路由发送数据包**

网卡驱动获取网络包之后，会将其复制到网卡内的缓存区中，接着会在其开头加上报头和起始帧分界符，在末尾加上用于检测错误的帧校验序列。
交换机根据 MAC 地址表查找 MAC 地址，然后将信号发送到相应的端口。